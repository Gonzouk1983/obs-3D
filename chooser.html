<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>OBS 3D URL Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, sans-serif; margin: 24px; }
    fieldset { border:1px solid #ddd; border-radius:10px; padding:16px; margin-bottom:16px; }
    label { display:block; margin:8px 0 4px; }
    input[type="text"], input[type="number"] { width: 100%; padding:8px; }
    .row { display:grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .out { background:#f5f5f5; padding:12px; border-radius:8px; word-break: break-all; }
    button { padding:10px 14px; border-radius:8px; border:1px solid #ccc; background:#fff; cursor:pointer; }
    .note { color:#666; font-size: 12px; }
  </style>
</head>
<body>
  <h1>OBS 3D URL Builder</h1>
  <fieldset>
    <legend>Model</legend>
    <label>Public GLB/GLTF URL</label>
    <input id="model" type="text" placeholder="https://example.com/models/duck.glb"
      value="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Assets/main/Models/Duck/glTF-Binary/Duck.glb" />
    <p class="note">Host the file publicly or use a CDN. For GitHub Pages, place the file in your repo and use its raw URL.</p>
  </fieldset>

  <fieldset>
    <legend>Transform & Scene</legend>
    <div class="row">
      <div>
        <label>Scale</label>
        <input id="scale" type="number" step="0.01" value="1"/>
      </div>
      <div>
        <label>Rotate X (deg)</label>
        <input id="rx" type="number" step="1" value="0"/>
      </div>
      <div>
        <label>Rotate Y (deg)</label>
        <input id="ry" type="number" step="1" value="25"/>
      </div>
      <div>
        <label>Rotate Z (deg)</label>
        <input id="rz" type="number" step="1" value="0"/>
      </div>
      <div>
        <label>Ambient (0–1)</label>
        <input id="ao" type="number" step="0.05" value="0.6"/>
      </div>
      <div>
        <label>Shadow (0/1)</label>
        <input id="shadow" type="number" step="1" value="1"/>
      </div>
      <div>
        <label>Camera Distance</label>
        <input id="cam" type="number" step="0.1" value="2.5"/>
      </div>
      <div>
        <label>Spin (deg/sec)</label>
        <input id="spin" type="number" step="1" value="0"/>
      </div>
      <div>
        <label>Background</label>
        <input id="bg" type="text" value="transparent" />
        <div class="note">Use 'transparent' or a hex like %23000000 for black.</div>
      </div>
    </div>
  </fieldset>

  <fieldset>
    <legend>Output</legend>
    <div class="out" id="out"></div>
    <p>
      <button id="copy">Copy URL</button>
      <button id="open">Open Preview</button>
    </p>
    <p class="note">Use this URL in an OBS Browser Source. Set width/height as needed (e.g. 1920×1080).</p>
  </fieldset>

  <script>
    const $ = (id) => document.getElementById(id);
    const inputs = ["model","scale","rx","ry","rz","ao","shadow","bg","cam","spin"].map($);
    const out = $("out");
    const build = () => {
      const params = new URLSearchParams();
      const base = new URL("viewer.html", location.href).toString();
      inputs.forEach(i => {
        if (i.value !== "" && !(i.id === "bg" && i.value === "transparent")) {
          params.set(i.id, i.value);
        } else if (i.id === "bg" && i.value === "transparent") {
          // omit to keep it default transparent
        }
      });
      const url = base + "?" + params.toString();
      out.textContent = url;
      return url;
    };
    inputs.forEach(i => i.addEventListener("input", build));
    $("copy").addEventListener("click", async () => {
      const url = build();
      await navigator.clipboard.writeText(url);
      alert("Copied URL to clipboard!");
    });
    $("open").addEventListener("click", () => {
      const url = build();
      window.open(url, "_blank");
    });
    build();
  </script>
</body>
</html>
